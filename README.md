# Сервис Асинхронного Управления Задачами

Асинхронный микросервис для приёма, хранения и фоновой обработки пользовательских задач с поддержкой приоритетов, масштабирования и отказоустойчивости.

---

## Техническое задание

> **Разработка асинхронного сервиса управления задачами**  
>
> **Описание**  
> Необходимо разработать сервис для асинхронной обработки задач с возможностью масштабирования и отказоустойчивости.
>
> **Функциональные требования**  
> 1. **Создание задач** через REST API  
> 2. **Асинхронная обработка** задач в фоновом режиме  
> 3. Возможность **параллельной обработки** нескольких задач  
> 4. Система **приоритетов** для задач  
>
> **Статусная модель задач**  
> - NEW — новая задача  
> - PENDING — ожидает обработки  
> - IN_PROGRESS — в процессе выполнения  
> - COMPLETED — завершено успешно  
> - FAILED — завершено с ошибкой  
> - CANCELLED — отменено  
>
> **Требования к задаче**  
> Каждая задача должна иметь уникальный идентификатор и содержать:  
> - название  
> - описание  
> - приоритет (LOW, MEDIUM, HIGH)  
> - статус  
> - время создания  
> - время начала выполнения  
> - время завершения  
> - результат выполнения  
> - информацию об ошибках (если есть)  
>
> **Технические требования**  
> - **Язык**: Python 3.10+  
> - **БД**: PostgreSQL 14+  
> - **Очередь**: RabbitMQ  
> - **Web-фреймворк**: FastAPI  
> - **ORM**: SQLAlchemy  
> - **Миграции**: Alembic  
> - **Документация API**: OpenAPI (Swagger)  
>
> **API Endpoints**  
> 1. `POST   /api/v1/tasks`             — создание задачи  
> 2. `GET    /api/v1/tasks`             — список задач (фильтрация, пагинация)  
> 3. `GET    /api/v1/tasks/{task_id}`   — информация о задаче  
> 4. `DELETE /api/v1/tasks/{task_id}`   — отмена задачи  
> 5. `GET    /api/v1/tasks/{task_id}/status` — статус задачи  
>
> **Тестирование**  
> - Unit-тесты (pytest)  
> - Интеграционные тесты  
>
> **Развертывание**  
> - Dockerfile для сервисов  
> - Docker Compose для локальной разработки  
> - Конфигурация через переменные окружения  
>
> **Критерии оценки**  
> - Чистота и читаемость кода  
> - Принципы SOLID  
> - Обработка ошибок  
> - Документация  
> - Покрытие тестами  
> - Производительность и масштабируемость  

---

## Стек технологий

- **Python** 3.10+  
- **FastAPI**  
- **SQLAlchemy (async)**  
- **PostgreSQL**  
- **RabbitMQ**  
- **AIO-Pika** (для работы с очередью)  
- **Alembic** (миграции)  
- **Pytest**, **pytest-cov**  
- **API документация: OpenAPI (Swagger)**

---

## Быстрый старт

1. **Клонируйте репозиторий**  
   ```bash
   git clone https://github.com/your-org/task-service.git
   cd task-service
   
2. **Файл окружение .env исутствует в проекте в качестве исключения**

3. **Запустить через Docker Compose**

	```bash
	docker-compose up -d --build  
	 ```
	Поднимутся сервисы:

	db (PostgreSQL)

	rabbitmq

	api (FastAPI + Uvicorn)
	
	
4. **Выполнить миграции**
	Миграции применятся при старте api. Вручную:

	```bash
	docker-compose run --rm api alembic upgrade head

5. **Документация**

	**Внимание порт выбран 9000, а не стандартный 8000!** Т.к. при разработке другие порты были заняты, либо зарезервированны. 
	
	Swagger UI: http://localhost:9000/docs

	ReDoc: http://localhost:9000/redoc
	
	
6. **Запустить фонового воркера**

	```bash
	docker-compose run --rm api python app/worker.py
	
	
## Запуск тестов и отчёт по покрытию

**Запустить все тесты:**
    
        ```bash
        docker-compose run --rm api pytest -q
    
    
**Отчёт по покрытию:**
    
        ```bash
        docker-compose run --rm api pytest --cov=app --cov-report=term --cov-report=html
    
Откройте htmlcov/index.html в браузере.